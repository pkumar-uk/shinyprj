{
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n#\n# http://shiny.rstudio.com\n#\n\nlibrary(shiny)\nlibrary(googleVis)\nlibrary(plyr)\n\nwhod<-read.csv(\"whodata1.csv\")\nselp<- c(\"GHOCD\",\"YEAR\",\"REGIOND\",\"INCMCD\",  \"CNTRYCD\",\"SEXCD\",\"Year\")\nselpd<- c(\"Life Expectancy Type\",\"YEAR\",\"Region\",\"Income Group\",  \"Country\",\"Sex\",\"Expectancy in Year\")\n\n\n\n\nshinyServer(function(input, output) {\n        \n        formulaText <- reactive({\n                paste(\"(Selection: Life Expectancy years > \",input$year, \n                      \";Data year~\", input$syear, \n                      \";Population Type~\", input$spop,\n                      \";Type of Life Expectancy~\", input$sghoc,\")\")       })\n        formulaText1 <- reactive({\n                paste(\"(Selection: Life Expectancy years > \",input$year, \n                      \";Population Type~\", input$spop,\n                      \";Type of Life Expectancy~\", input$sghoc,\")\")       })\n        \n        output$caption <- renderText({\n                                formulaText()\n        })\n        \n        output$caption3 <- renderText({\n                formulaText1()\n        })\n        \n        output$caption1 <- renderText({\n                tx1<-input$sghoc\n                if (tx1==\"WHOSIS_000001\") {tx2 <- \"Life expectancy at birth\"}\n                if (tx1==\"WHOSIS_000002\") {tx2 <- \"Healthy life expectancy (HALE) at birth\"}\n                if (tx1==\"WHOSIS_000015\") {tx2 <- \"Life expectancy at age 60\"}\n                tx2 <- paste(\"Type of Life Expectancy:\",tx2, \" for year \", input$syear)\n                return(tx2)\n        })\n        \n        output$caption2 <- renderText({\n                tx1<-input$sghoc\n                if (tx1==\"WHOSIS_000001\") {tx2 <- \"Life expectancy at birth\"}\n                if (tx1==\"WHOSIS_000002\") {tx2 <- \"Healthy life expectancy (HALE) at birth\"}\n                if (tx1==\"WHOSIS_000015\") {tx2 <- \"Life expectancy at age 60\"}\n                tx2 <- paste(\"Type of Life Expectancy:\",tx2)\n                return(tx2)\n        })\n        \n        \n        output$mplot1 <- renderGvis({\n                pyears <- input$year\n                psyear <- input$syear\n                pspop  <- input$spop\n                psghoc <- input$sghoc\n                if (input$WB_HI == TRUE) { w1<-c(\"WB_HI\")}   else { w1<-c(\"\")}\n                if (input$WB_LI == TRUE) { w2<-c(\"WB_LI\")}   else { w2<-c(\"\")}\n                if (input$WB_LMI == TRUE) { w3<-c(\"WB_LMI\")} else { w3<-c(\"\")}\n                if (input$WB_UMI == TRUE) { w4<-c(\"WB_UMI\")} else { w4<-c(\"\")}\n                pinc<-c(w1,w2,w3,w4)\n                p1 <- whod[whod$SEXC==pspop & whod$GHOC==psghoc & whod$YEAR==psyear & whod$INCMC %in% pinc & whod$Year > pyears,selp]\n                p2<-p1[,c(\"CNTRYCD\",\"Year\")]\n                names(p2)<- c(\"Country\",\"Life Expectancy(yrs)\")\n                p3 <- ddply(p1,.(REGIOND,INCMCD),summarize,Life=floor(mean(Year)))\n                names(p3)<-c(\"Region\",\"Income Group\",\"Life Expectancy(yrs)\")\n\n                m<-gvisGeoChart(p1, locationvar=\"CNTRYCD\",colorvar=\"Year\",  \n                                options=list( height=350,displayMode='auto', \n                                              colorAxis=\"{values:[40,60,75,80],colors:[\\'red', \\'pink\\', \\'orange',\\'green']}\"))\n                q<-gvisTable(p3,options=list(page=\"enable\",pageSize=5,sort=\"enable\"))\n                p<-gvisTable(p2,options=list(page=\"enable\",pageSize=5,sort=\"enable\"))\n                gt<-gvisMerge(q,p,horizontal=TRUE,\n                              tableOptions=\"cellspacing=\\\"20\\\" bgcolor=\\\"#AABBCC\\\"\")\n                gtm <- gvisMerge(m,gt, horizontal=FALSE,\n                             tableOptions=\"bgcolor=\\\"#CCCCCC\\\" cellspacing=10\")\n                return(gtm)\n        })\n\n        output$mplot2 <- renderGvis({\n                pyears <- input$year\n                psyear <- input$syear\n                pspop  <- input$spop\n                psghoc <- input$sghoc\n                if (input$WB_HI == TRUE) { w1<-c(\"WB_HI\")}   else { w1<-c(\"\")}\n                if (input$WB_LI == TRUE) { w2<-c(\"WB_LI\")}   else { w2<-c(\"\")}\n                if (input$WB_LMI == TRUE) { w3<-c(\"WB_LMI\")} else { w3<-c(\"\")}\n                if (input$WB_UMI == TRUE) { w4<-c(\"WB_UMI\")} else { w4<-c(\"\")}\n                pinc<-c(w1,w2,w3,w4)\n                p1 <- whod[whod$SEXC==pspop & whod$GHOC==psghoc & whod$YEAR==psyear & whod$INCMC %in% pinc & whod$Year > pyears,selp]\n                p2 <- whod[whod$SEXC==pspop & whod$GHOC==psghoc & whod$INCMC %in% pinc & whod$Year > pyears,selp]\n                p3<- p2\n                names(p3)<- selpd\n                p<-t<-gvisMotionChart(p2,idvar=\"CNTRYCD\",timevar=\"YEAR\", colorvar=\"CNTRYCD\")\n                \n                return(p)\n                \n        })\n        \n\n\n})\n",
    "created" : 1411193441220.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3603391777",
    "id" : "9A4EE165",
    "lastKnownWriteTime" : 1411204222,
    "path" : "C:/Users/kumar_000/Desktop/Coursera/ShinyPrj1/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}